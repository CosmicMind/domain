"use strict";var x=Object.defineProperty;var V=(i,t,e)=>t in i?x(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var a=(i,t,e)=>(V(i,typeof t!="symbol"?t+"":t,e),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const f=require("@cosmicmind/foundationjs"),S=require("@cosmicmind/patternjs");class v extends f.FoundationError{}const y=(i={})=>t=>p(t,i);function $(i){return{set(t,e,s){var n,c,r,b;const o=(n=i.attributes)==null?void 0:n[e];if(((c=o==null?void 0:o.validate)==null?void 0:c.call(o,s,t))===!1)throw new v(`${String(e)} is invalid`);(r=o==null?void 0:o.updated)==null||r.call(o,s,t[e],t);const u=Reflect.set(t,e,s);return(b=i.trace)==null||b.call(i,t),u}}}function p(i,t={}){var e,s,o,u;if(f.guard(i)){const{attributes:n}=t,c=new Proxy(i,$(t));if(f.guard(n)){for(const r in n)if(((s=(e=n[r])==null?void 0:e.validate)==null?void 0:s.call(e,i[r],c))===!1)throw new v(`${String(r)} is invalid`);return(o=t.created)==null||o.call(t,c),(u=t.trace)==null||u.call(t,c),c}}throw new v("Unable to create Entity")}class g extends S.Observable{}class E extends f.FoundationError{}const A=(i={})=>t=>P(t,i);function O(i){return{set(t,e,s){var n,c,r;const o=(n=i.attributes)==null?void 0:n[e];if(((c=o==null?void 0:o.validate)==null?void 0:c.call(o,s,t))===!1)throw new E(`${String(e)} is invalid`);const u=Reflect.set(t,e,s);return(r=i.trace)==null||r.call(i,t),u}}}function P(i,t={}){var e,s,o,u;if(f.guard(i)){const{attributes:n}=t,c=new Proxy(i,O(t));if(f.guard(n)){for(const r in n)if(((s=(e=n[r])==null?void 0:e.validate)==null?void 0:s.call(e,i[r],c))===!1)throw new E(`${String(r)} is invalid`);return(o=t.created)==null||o.call(t,c),(u=t.trace)==null||u.call(t,c),c}}throw new E("Unable to create Event")}class j extends g{constructor(e){super();a(this,"root");this.root=e}}function F(i,t={}){const e=y(t);return s=>new i(e(s))}class H{constructor(t){a(this,"_value");this._value=t}get value(){return this._value}}class w extends f.FoundationError{}const R=(i,t={})=>e=>q(new i(e),e,t);function _(i){return{set(t,e,s){var o;if(((o=i.validate)==null?void 0:o.call(i,s,t))===!1)throw new w(`${String(e)} is invalid`);return Reflect.set(t,e,s)}}}function q(i,t,e={}){var s,o,u;if(f.guard(i)){const n=new Proxy(i,_(e));if(((s=e.validate)==null?void 0:s.call(e,t,n))===!1)throw new w("value is invalid");return(o=e.created)==null||o.call(e,n),(u=e.trace)==null||u.call(e,n),n}throw new w("unable to create value")}exports.Aggregate=j;exports.EntityError=v;exports.EventError=E;exports.EventObservable=g;exports.Value=H;exports.ValueError=w;exports.defineAggregate=F;exports.defineEntity=y;exports.defineEvent=A;exports.defineValue=R;
